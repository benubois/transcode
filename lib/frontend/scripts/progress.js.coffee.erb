window.transcode = window.transcode || {}

transcode.pusher = new Pusher('<%= Transcode.config.pusher_key %>')
transcode.channel = transcode.pusher.subscribe('progress_updates')

transcode.channel.bind 'progress', (message) ->
  $("[data-id='#{message.id}']").find(".progress-inner").css({width: "#{message.progress}%"})
  circle = $("[data-id='#{message.id}']").find(".progress-circle").attr('id')
  transcode.progressCircle(circle, message.progress) if circle
